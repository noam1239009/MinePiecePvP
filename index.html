<!DOCTYPE html>
<!-- Firebase SDKs -->
<script type="module">
  // Import the Firebase functions you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getDatabase, ref, set, get, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "one-piece-pvp.firebaseapp.com",
    databaseURL: "https://one-piece-pvp-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "one-piece-pvp",
    storageBucket: "one-piece-pvp.appspot.com",
    messagingSenderId: "316552757064",
    appId: "1:316552757064:web:6f1804aef748ef40a518c7"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Example: Save user data
  window.saveScore = function(username, score) {
    set(ref(db, 'leaderboard/' + username), {
      score: score
    });
  };

  // Example: Display leaderboard
  window.loadLeaderboard = function() {
    const leaderboardRef = ref(db, 'leaderboard/');
    onValue(leaderboardRef, (snapshot) => {
      const data = snapshot.val();
      const leaderboardDiv = document.getElementById("leaderboard");
      leaderboardDiv.innerHTML = "";

      const sortedUsers = Object.entries(data || {}).sort((a, b) => b[1].score - a[1].score);

      sortedUsers.forEach(([username, userData]) => {
        leaderboardDiv.innerHTML += `<p>${username}: ${userData.score}</p>`;
      });
    });
  };
</script>

<html>

<head>
  <meta charset="UTF-8" />
  <title>One Piece Minecraft PvP</title>
  <link rel="stylesheet" href="style.css" />

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-database.js"></script>

  <script src="firebase-config.js" defer></script>
  <script src="auth.js" defer></script>
  <script src="leaderboard.js" defer></script>
</head>

<body>
  <h1>🏴‍☠️ One Piece Minecraft PvP Leaderboard</h1>

  <section id="auth">
    <h2>Register / Login</h2>
    <input type="email" id="email" placeholder="Gmail" />
    <input type="text" id="mcname" placeholder="Minecraft Username" />
    <input type="password" id="password" placeholder="Password" />
    <br />
    <button onclick="register()">Register</button>
    <button onclick="login()">Login</button>
  </section>

  <hr>

  <section>
    <h2>🏆 Leaderboard</h2>
    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Username</th>
          <th>MC Name</th>
          <th>ELO</th>
        </tr>
      </thead>
      <tbody id="leaderboard-body"></tbody>
    </table>
  </section>
</body>

</html>
